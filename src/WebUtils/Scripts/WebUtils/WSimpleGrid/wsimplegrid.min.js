(function (a) { a.fn.wsimplegrid = function (b) { var c = $(this); var d = { columnClass: "wsimpleGrid", filterButtonValue: "Filtrar", removeFilterButtonValue: "Remover filtro" }; var e; var f; var g = c.find("tbody tr"); var h = a.extend(d, b); var i = $("." + h.columnClass); var j; var k = function () { i.append('<div class="wsimplegrid-filter-icon wsimplegrid-item wsimplegrid-filter-icon-fix"></div>').click(function (a) { var b = $('<input type="text" name="filter" class="wsimplegrid-item" />'); var d = $('<div name="filter-button" class="wbutton wbutton-normal">' + h.filterButtonValue + "</div>"); var k = $('<div name="remove-filter-button" class="wbutton wbutton-alert">' + h.removeFilterButtonValue + "</div>"); if ($(a.target).hasClass("wsimplegrid-filter-icon-fix")) { a.stopPropagation(); var l = $(this).index(); var m = 0; i.each(function () { if (this.cellIndex == l) { j = m } m++ }); var n = function (a, b, c) { var d = i.eq(b); var g = i.eq(c); if (a == true) { d.find(".wsimplegrid-filter-icon").addClass("wsimplegrid-filter-icon-active"); d.find(".wsimplegrid-filter-icon").removeClass("wsimplegrid-filter-icon"); e = true } else { g.find(".wsimplegrid-filter-icon-active").addClass("wsimplegrid-filter-icon"); g.find(".wsimplegrid-filter-icon-active").removeClass("wsimplegrid-filter-icon-active"); e = false; f = c } }; $(".wsimplegrid-filter-panel").remove(); var o = $('<div class="wsimplegrid-filter-panel wsimplegrid-item" index-filter="' + $(a.target).parent().index(".filtrar") + '"></div>').css("top", a.pageY + 18 + "px").css("left", a.pageX + 5 + "px"); d.click(function () { if (b.val() != "") { $(".wsimplegrid-filter-icon-fix").eq(j).parent().removeAttr("filter-key"); if ($(c).find("thead th[filter-key]").length == 0) { g.show() } $(".wsimplegrid-filter-icon-fix").eq(j).parent().attr("filter-key", b.val()); $(c).find("thead th[filter-key]").each(function () { $(c).find("tbody tr:visible").each(function () { if ($(this).find("td:eq(" + l + ")").text().indexOf(b.val()) < 0) { $(this).find("td:eq(" + l + ")").parent().hide() } }) }); n(true, j) } }); k.click(function () { var a = $(this).parent().attr("index-filter"); if (b.attr("filter-input-key") != "") { $(".filtrar:eq(" + $(".wsimplegrid-item").eq(a).index(".wsimplegrid-item") + ")").removeAttr("filter-key"); var d = 0; if ($(c).find("thead th[filter-key]").length == 0) { g.show() } else { $(c).find("thead th[filter-key]").each(function () { var a = $(this).index(); var b = $(this).attr("filter-key"); if (d == 0) { $(c).find("tbody tr:hidden").each(function () { if ($(this).find("td:eq(" + a + ")").text().indexOf(b) >= 0) { $(this).find("td:eq(" + a + "):contains(" + b + ")").parent().show() } }) } else { $(c).find("tbody tr:visible").each(function () { if ($(this).find("td:eq(" + a + ")").text().indexOf(b) >= 0) { $(this).find("td:eq(" + a + "):contains(" + b + ")").parent().show() } else { $(this).find("td:eq(" + a + ")").parent().hide() } }) } d++ }) } n(false, j, a) } }); var p = $(".wsimplegrid-filter-icon-fix").eq(j).parent().attr("filter-key"); if (p) { o.append(b).append(d).append(k); b.val(p); b.attr("filter-input-key", p) } else { o.append(b).append(d); b.val(p); b.attr("filter-input-key", p) } $("body").append(o); b.focus(); b.keypress(function () { if (event.keyCode == 13) { d.trigger("click") } }) } }) }; k() } })(jQuery); jQuery(document).click(function (a) { if (!$(a.target).hasClass("wsimplegrid-item")) { $(".wsimplegrid-filter-panel").remove() } })